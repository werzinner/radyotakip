<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radyoloji Staj Takibi: TEK A4 Sayfasƒ±na Sƒ±ƒüdƒ±rƒ±ldƒ± (Lokal Depolama Eklendi)</title>
    <style>
        /* YAZDIRMA KENAR BO≈ûLUKLARINI SIFIRLA */
        @page {
            size: A4;
            margin: 0.5cm; /* Kaƒüƒ±t bo≈üluƒüunu minimuma indirir */
        }
        
        body {
            font-family: Arial, sans-serif;
            margin: 10px; 
            background-color: #f4f4f4;
        }
        h2 {
            color: #333;
            font-size: 18px; 
        }
        .controls {
            margin-bottom: 10px;
            text-align: right;
        }
        .print-btn {
            padding: 8px 15px; 
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5pX;
            font-size: 14px;
        }
        .print-btn:hover {
            background-color: #45a049;
        }
        .printable-table {
            width: 100%;
            border-collapse: collapse;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); 
            background-color: #ffffff;
        }
        .printable-table th, .printable-table td {
            border: 1px solid #ddd;
            padding: 0;
            text-align: center;
            vertical-align: middle;
            font-size: 9px;
            position: relative;
            height: 35px;
        }
        .printable-table th {
            background-color: #e9e9e9;
            color: #333;
            font-weight: bold;
            padding: 3px 0;
            height: 40px;
        }
        /* S√úTUN STƒ∞LLERƒ∞ */
        .date-col {
            background-color: #f0f8ff;
            font-weight: bold;
            width: 45px;
            min-width: 45px;
        }
        .student-header {
            width: 48px;
            min-width: 48px;
            font-size: 9px; 
            padding: 2px;
        }
        
        /* Select kutusu stilizasyonu */
        .procedure-select {
            width: 100%;
            height: 100%;
            padding: 1px;
            border: none;
            background-color: transparent;
            font-size: 8px; 
            box-sizing: border-box;
            cursor: pointer;
            -webkit-appearance: none; 
            -moz-appearance: none;
            appearance: none;
            text-align: center;
            text-align-last: center; 
            outline: none; 
        }

        /* Se√ßim Yapƒ±ldƒ±ƒüƒ±nda select kutusunun arka plan rengi */
        .procedure-select[value="PANOROMIK"] { background-color: #C8E6C9; }
        .procedure-select[value="PERIAPIKAL"] { background-color: #FFF9C4; }
        .procedure-select[value="ASISTE"] { background-color: #FFCDD2; }
        .procedure-select[value="MUAYENE"] { background-color: #BBDEFB; }
        
        /* Se√ßilen metni yazdƒ±rƒ±rken kullanmak i√ßin gizli span */
        .print-value {
            display: none; 
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #333;
            pointer-events: none; 
            box-sizing: border-box;
        }

        /* YAZDIRMA STƒ∞LLERƒ∞: GENEL TABLO √ñL√áEKLENDƒ∞RMESƒ∞ (%80) */
        @media print {
            .controls {
                display: none;
            }
            body {
                margin: 0;
                padding: 0;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
            }
            .printable-table {
                /* TABLOYU %80 ORANINDA K√ú√á√úLTEN TEMEL KOD */
                transform: scale(0.8);
                transform-origin: top left;
                
                /* Konumlandƒ±rma ve boyutlandƒ±rma */
                position: absolute;
                top: 0;
                left: 0;
                width: 125% !important; 
                table-layout: fixed;
            }
            
            /* Diƒüer Yazdƒ±rma Stilleri */
            .printable-table th, .printable-table td {
                border: 1px solid #000 !important;
                vertical-align: middle !important;
                text-align: center !important;
                height: 35px;
                padding: 0;
            }
            .date-col {
                width: 45px !important; 
                min-width: 45px !important;
                font-size: 8px !important;
            }
            .student-header {
                width: 48px !important; 
                min-width: 48px !important;
                font-size: 8px;
            }
            .procedure-select {
                display: none !important;
            }
            .print-value {
                display: flex !important; 
                font-size: 9px;
                font-weight: 800; 
                line-height: 1; 
            }

            /* Renklendirme ve kenarlƒ±klar (Yazdƒ±rma i√ßin) */
            .print-value.PANOROMIK { background-color: #C8E6C9 !important; color: #2e7d32 !important; border: 1px solid #2e7d32 !important;}
            .print-value.PERIAPIKAL { background-color: #FFF9C4 !important; color: #f9a825 !important; border: 1px solid #f9a825 !important;}
            .print-value.ASISTE { background-color: #FFCDD2 !important; color: #c62828 !important; border: 1px solid #c62828 !important;}
            .print-value.MUAYENE { background-color: #BBDEFB !important; color: #1565c0 !important; border: 1px solid #1565c0 !important;}
        }
    </style>
    <script>
        const STORAGE_KEY = 'radiologyStajSelections';

        const students = [
            "Cennet Yƒ±ldƒ±z", "Nida Nur Solak", "Simge D√ºzen", 
            "Ahmet Kalaycƒ±", "Pelin Balkesen", "Muhammed Eren Akta≈ü", 
            "Ece Kele≈ü", "Mehmet Baran Birlik", "S√ºmeyra Kavas",  
            "Fatma Zehra Ya≈üar", "Abdullah Y√ºzer"
        ];
        
        const startDate = new Date('2025-11-10');
        const endDate = new Date('2025-12-04');
        const workDays = [];
        
        for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
            const dayOfWeek = d.getDay();
            if (dayOfWeek !== 0 && dayOfWeek !== 6) { 
                workDays.push({
                    date: new Date(d).toLocaleDateString('tr-TR', { day: '2-digit', month: 'short' }).replace('.', ''),
                    fullDate: new Date(d).toLocaleDateString('tr-TR', { weekday: 'short', day: '2-digit', month: 'short' })
                });
            }
        }

        /**
         * T√ºm select kutularƒ±ndaki deƒüerleri localStorage'a kaydeder.
         */
        function saveSelections() {
            const selections = {};
            document.querySelectorAll('.procedure-select').forEach(selectElement => {
                if (selectElement.value) {
                    selections[selectElement.id] = selectElement.value;
                }
            });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(selections));
        }

        /**
         * localStorage'dan verileri y√ºkler ve select kutularƒ±nƒ± g√ºnceller.
         */
        function loadSelections() {
            const storedData = localStorage.getItem(STORAGE_KEY);
            if (!storedData) return;

            const selections = JSON.parse(storedData);
            
            for (const id in selections) {
                const selectElement = document.getElementById(id);
                if (selectElement) {
                    selectElement.value = selections[id];
                    // CSS ile arka plan rengini g√ºncellemek i√ßin value √∂zelliƒüini kullan
                    selectElement.setAttribute('value', selections[id]);
                }
            }
        }

        /**
         * Yazdƒ±rma i≈ülemi i√ßin select deƒüerlerini print-value span'lerine aktarƒ±r.
         */
        function printTable() {
            document.querySelectorAll('.procedure-select').forEach(selectElement => {
                const printValueSpan = selectElement.nextElementSibling; 
                if (selectElement.value && selectElement.value !== "") {
                    printValueSpan.textContent = selectElement.value;
                    printValueSpan.className = 'print-value ' + selectElement.value; 
                } else {
                    printValueSpan.textContent = ''; 
                    printValueSpan.className = 'print-value'; 
                }
            });
            window.print();
        }
        
        // --- Tabloyu Olu≈üturma ve Olay Dinleyicileri ---
        window.onload = function() {
            const tableBody = document.getElementById('table-body');
            const tableHead = document.getElementById('table-head');
            
            // Ba≈ülƒ±k satƒ±rƒ± (Tarih ve √ñƒürenci ƒ∞simleri)
            let headerHtml = '<tr><th class="date-col">TARƒ∞H</th>';
            students.forEach(student => {
                headerHtml += `<th class="student-header">${student}</th>`;
            });
            headerHtml += '</tr>';
            tableHead.innerHTML = headerHtml;

            // Veri satƒ±rlarƒ± (Her i≈ü g√ºn√º bir satƒ±r)
            let bodyHtml = '';
            workDays.forEach((day, dayIndex) => {
                bodyHtml += `<tr><td class="date-col" title="${day.fullDate}">${day.date}</td>`;
                
                students.forEach((student, studentIndex) => {
                    const selectId = `select-${dayIndex}-${studentIndex}`;
                    
                    bodyHtml += `<td>
                        <select class="procedure-select" id="${selectId}">
                            <option value="">Se√ßim Yapƒ±n</option>
                            <option value="PANOROMIK">PANOROMƒ∞K</option>
                            <option value="PERIAPIKAL">PERƒ∞APƒ∞KAL</option>
                            <option value="ASISTE">ASƒ∞STE</option>
                            <option value="MUAYENE">MUAYENE</option>
                        </select>
                        <span class="print-value"></span> 
                    </td>`;
                });
                bodyHtml += '</tr>';
            });
            tableBody.innerHTML = bodyHtml;

            // Verileri y√ºkle
            loadSelections();

            // Olay dinleyicilerini ekle (Se√ßim deƒüi≈ütiƒüinde kaydet)
            document.querySelectorAll('.procedure-select').forEach(selectElement => {
                // value attribute'unu set etme i≈ülevi
                const updateBgColor = (e) => {
                    const value = e.target.value;
                    if (value) {
                         e.target.setAttribute('value', value);
                    } else {
                        e.target.removeAttribute('value');
                    }
                };
                
                // ƒ∞lk y√ºklemede arka planƒ± ayarla
                updateBgColor({target: selectElement}); 

                // Deƒüi≈üiklikte kaydet ve arka planƒ± ayarla
                selectElement.addEventListener('change', function(e) {
                    updateBgColor(e);
                    saveSelections();
                });
            });
        };
    </script>
</head>
<body>

    <h2>ü¶∑ Radyoloji Staj Takibi: 10 Kasƒ±m - 4 Aralƒ±k 2025</h2>

    <div class="controls">
        <p style="text-align: left; float: left; margin: 0; font-size: 13px;">
            **Kutucuk A√ßƒ±klamasƒ±:**
            <span style="background-color: #C8E6C9; padding: 2px 5px; border-radius: 3px; border: 1px solid #2e7d32; color: #2e7d32; font-weight: bold;">Panoromik</span> |
            <span style="background-color: #FFF9C4; padding: 2px 5px; border-radius: 3px; border: 1px solid #f9a825; color: #f9a825; font-weight: bold;">Periapikal</span> |
            <span style="background-color: #FFCDD2; padding: 2px 5px; border-radius: 3px; border: 1px solid #c62828; color: #c62828; font-weight: bold;">Asiste</span> |
            <span style="background-color: #BBDEFB; padding: 2px 5px; border-radius: 3px; border: 1px solid #1565c0; color: #1565c0; font-weight: bold;">Muayene</span>
        </p>
        <button class="print-btn" onclick="printTable()">üñ®Ô∏è Tabloyu Yazdƒ±r</button>
    </div>

    <table class="printable-table">
        <thead>
            <tr id="table-head">
                </tr>
        </thead>
        <tbody id="table-body">
            </tbody>
    </table>

</body>
</html>
